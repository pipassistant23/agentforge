# AgentForge Environment Variables Configuration
# Copy this file to .env and fill in your actual values
# NEVER commit .env to version control

# ============================================================================
# REQUIRED - Core Configuration
# ============================================================================

# Telegram Bot Token (required for Telegram channel)
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz1234567890

# ============================================================================
# AUTHENTICATION - Choose ONE of these options
# ============================================================================

# Option 1: Anthropic API (pay-per-use)
ANTHROPIC_API_KEY=sk-ant-api03-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Option 2: Claude Code OAuth (subscription)
# CLAUDE_CODE_OAUTH_TOKEN=your-oauth-token-here

# Option 3: Custom Anthropic-compatible provider
# Use these when connecting to alternative API providers (OpenRouter, etc.)
# ANTHROPIC_AUTH_TOKEN=your-api-key-here
# ANTHROPIC_BASE_URL=https://your-provider.example.com
# ANTHROPIC_MODEL=claude-sonnet-4-20250514

# ============================================================================
# OPTIONAL - Telegram Agent Swarm
# ============================================================================

# Telegram Bot Pool for Agent Swarm (comma-separated tokens)
# Each sub-agent gets assigned a different bot for identity
# Leave empty to disable bot pool / agent swarm
TELEGRAM_BOT_POOL=1111111111:AAA,2222222222:BBB,3333333333:CCC

# ============================================================================
# OPTIONAL - Assistant Configuration
# ============================================================================

# Assistant name (default: Andy)
# This name appears in:
# - Agent prompts and identity (CLAUDE.md files use {{ASSISTANT_NAME}})
# - Trigger patterns (@AssistantName in groups)
# - Conversation transcripts
#
# REBRANDING: Change this to rebrand the entire application
# Example: ASSISTANT_NAME=MyAssistant
ASSISTANT_NAME=AgentForge

# Main group folder name (default: main)
MAIN_GROUP_FOLDER=main

# ============================================================================
# OPTIONAL - Logging
# ============================================================================

# Log level: error, warn, info, debug (default: info)
LOG_LEVEL=info

# ============================================================================
# OPTIONAL - Poll Intervals (milliseconds)
# ============================================================================

# Main message poll interval (default: 2000ms = 2 seconds)
POLL_INTERVAL=2000

# Scheduler poll interval (default: 60000ms = 1 minute)
SCHEDULER_POLL_INTERVAL=60000

# IPC poll interval for orchestrator (default: 1000ms = 1 second)
IPC_POLL_INTERVAL=1000

# IPC poll interval for agent processes (default: 500ms)
AGENT_IPC_POLL_MS=500

# ============================================================================
# OPTIONAL - Queue Configuration
# ============================================================================

# Maximum retries for failed messages (default: 5)
QUEUE_MAX_RETRIES=5

# Base retry delay in milliseconds (default: 5000ms = 5 seconds)
# Actual delay uses exponential backoff
QUEUE_BASE_RETRY_MS=5000

# ============================================================================
# OPTIONAL - Timeout Configuration
# ============================================================================

# Maximum time an agent process can run (default: 1800000ms = 30 minutes)
# AGENT_TIMEOUT=1800000

# Maximum time an agent can be idle before its stdin is closed (default: 1800000ms = 30 minutes)
# IDLE_TIMEOUT=1800000

# Grace period added to idle timeout before hard kill (default: 30000ms = 30 seconds)
TIMEOUT_GRACE_PERIOD=30000

# Maximum agent stdout/stderr size in bytes before truncation (default: 10485760 = 10MB)
# AGENT_MAX_OUTPUT_SIZE=10485760

# Maximum number of concurrent agent processes (default: 5)
# MAX_CONCURRENT_PROCESSES=5

# ============================================================================
# OPTIONAL - Gmail Channel
# ============================================================================

# Gmail address to monitor for incoming tasks (leave empty to disable)
GMAIL_USER=

# Gmail App Password (generate at https://myaccount.google.com/apppasswords)
# Note: this is NOT your regular Google account password
GMAIL_APP_PASSWORD=

# Gmail label that triggers AgentForge processing (default: AgentForge)
GMAIL_TRIGGER_LABEL=AgentForge

# Subject prefix filter for trigger emails (empty = match all subjects)
GMAIL_TRIGGER_SUBJECT=

# How often to poll Gmail for new messages (default: 60000ms = 1 minute)
GMAIL_POLL_INTERVAL=60000

# ============================================================================
# OPTIONAL - Telegram Configuration
# ============================================================================

# Delay for Telegram bot name propagation (default: 2000ms = 2 seconds)
# Used when renaming pool bots to match sub-agent identities
TELEGRAM_NAME_PROPAGATION_DELAY=2000

# ============================================================================
# OPTIONAL - Directory Overrides
# ============================================================================

# Override default directory paths (defaults are relative to project root)
# Only set these if you need custom deployment layout

# Store directory (default: ./store)
# STORE_DIR=/custom/path/to/store

# Groups directory (default: ./groups)
# GROUPS_DIR=/custom/path/to/groups

# Data directory (default: ./data)
# DATA_DIR=/custom/path/to/data

# ============================================================================
# OPTIONAL - Agent Workspace Paths (Baremetal Mode)
# ============================================================================

# Workspace paths for baremetal agent execution
# These are used by agent processes, not the orchestrator
# Defaults work for standard deployment

# Workspace IPC directory (default: /workspace/ipc)
# WORKSPACE_IPC=/custom/workspace/ipc

# Workspace group directory (default: /workspace/group)
# WORKSPACE_GROUP=/custom/workspace/group

# Workspace global directory (default: /workspace/global)
# WORKSPACE_GLOBAL=/custom/workspace/global

# Workspace extra directory (default: /workspace/extra)
# WORKSPACE_EXTRA=/custom/workspace/extra

# ============================================================================
# OPTIONAL - MCP Configuration
# ============================================================================

# MCP server name (default: agentforge)
# MCP_SERVER_NAME=agentforge

# Environment variable prefix for IPC (default: AGENTFORGE)
# ENV_PREFIX=AGENTFORGE

# ============================================================================
# OPTIONAL - IPC Protocol Configuration (Advanced)
# ============================================================================

# Output markers for IPC protocol (must match between orchestrator and agent)
# Only change these if you've modified the source code
# OUTPUT_START_MARKER=---AGENTFORGE_OUTPUT_START---
# OUTPUT_END_MARKER=---AGENTFORGE_OUTPUT_END---

# ============================================================================
# OPTIONAL - Secret Management
# ============================================================================

# Comma-separated list of environment variables to strip from Bash subprocesses
# (default: ANTHROPIC_API_KEY,CLAUDE_CODE_OAUTH_TOKEN)
# SECRET_ENV_VARS=ANTHROPIC_API_KEY,CLAUDE_CODE_OAUTH_TOKEN,OTHER_SECRET

# ============================================================================
# OPTIONAL - Agent Tuning
# ============================================================================

# Locale for timestamp formatting (default: en-US)
# LOCALE=en-US

# Maximum filename length for archived conversations (default: 50)
# MAX_FILENAME_LENGTH=50

# Maximum message length for archived conversations (default: 2000)
# MAX_MESSAGE_LENGTH=2000

# ============================================================================
# Notes
# ============================================================================

# 1. Required variables:
#    - ANTHROPIC_API_KEY (get from https://console.anthropic.com)
#    - TELEGRAM_BOT_TOKEN (get from @BotFather on Telegram)
#
# 2. All other variables have sensible defaults and are optional
#
# 3. Integer values are parsed with parseInt(), invalid values fall back to defaults
#
# 4. Directory paths can be absolute or relative to project root
#
# 5. After modifying .env, restart the service:
#    sudo systemctl restart agentforge.service
#
# 6. Check logs after restart:
#    sudo journalctl -u agentforge.service -f
#
# 7. Never commit your .env file - keep secrets safe!

# ============================================================================
# Example Production Configuration
# ============================================================================

# Minimal production setup:
# ANTHROPIC_API_KEY=sk-ant-api03-xxxxx
# TELEGRAM_BOT_TOKEN=1234567890:ABCxxx
# LOG_LEVEL=warn
# POLL_INTERVAL=3000
# SCHEDULER_POLL_INTERVAL=300000

# Agent Swarm setup (multiple sub-agents with unique bot identities):
# TELEGRAM_BOT_POOL=1111111111:AAA,2222222222:BBB,3333333333:CCC
# ASSISTANT_NAME=AgentForge

# High-traffic setup (faster polling, more retries):
# POLL_INTERVAL=1000
# IPC_POLL_INTERVAL=500
# AGENT_IPC_POLL_MS=250
# QUEUE_MAX_RETRIES=10
# QUEUE_BASE_RETRY_MS=3000

# Debug setup (verbose logging, slower polling for observation):
# LOG_LEVEL=debug
# POLL_INTERVAL=5000
# AGENT_IPC_POLL_MS=1000

# ============================================================================
# OPTIONAL - QMD Memory System Configuration
# ============================================================================

# QMD models directory (shared across all groups, default: ./data/qmd/models)
# Models are auto-downloaded on first use (~2GB total)
QMD_MODELS_PATH=/absolute/path/to/agentforge/data/qmd/models

# Enable LLM reranking with Qwen3 (default: 1)
# Set to 0 to use only BM25 + vector search (faster, less accurate)
QMD_ENABLE_RERANKING=1

# Temporal decay half-life in days (default: 30)
# Recent memories weighted higher in search results
QMD_TEMPORAL_DECAY_DAYS=30

# Enable hybrid search (BM25 + vector, default: 1)
# Set to 0 to use only BM25 (faster indexing, no embeddings)
QMD_HYBRID_SEARCH=1

# ============================================================================
# OPTIONAL - Dream Cycle Configuration
# ============================================================================

# Timezone for dream cycle and morning brief (default: America/New_York)
# Dream cycle runs at 11:30 PM, morning brief at 8:00 AM in this timezone
DREAM_CYCLE_TIMEZONE=America/New_York

# Main DM chat ID for morning brief delivery
# Get this from a Telegram message or bot info
# MAIN_DM_CHAT_ID=123456789
